"use strict";(self.webpackChunkwkrk_docs=self.webpackChunkwkrk_docs||[]).push([[562],{3905:function(e,t,n){n.d(t,{Zo:function(){return d},kt:function(){return m}});var r=n(7294);function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,r,s=function(e,t){if(null==e)return{};var n,r,s={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(s[n]=e[n]);return s}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(s[n]=e[n])}return s}var i=r.createContext({}),p=function(e){var t=r.useContext(i),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},d=function(e){var t=p(e.components);return r.createElement(i.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},c=r.forwardRef((function(e,t){var n=e.components,s=e.mdxType,a=e.originalType,i=e.parentName,d=l(e,["components","mdxType","originalType","parentName"]),c=p(n),m=s,k=c["".concat(i,".").concat(m)]||c[m]||u[m]||a;return n?r.createElement(k,o(o({ref:t},d),{},{components:n})):r.createElement(k,o({ref:t},d))}));function m(e,t){var n=arguments,s=t&&t.mdxType;if("string"==typeof e||s){var a=n.length,o=new Array(a);o[0]=c;var l={};for(var i in t)hasOwnProperty.call(t,i)&&(l[i]=t[i]);l.originalType=e,l.mdxType="string"==typeof e?e:s,o[1]=l;for(var p=2;p<a;p++)o[p]=n[p];return r.createElement.apply(null,o)}return r.createElement.apply(null,n)}c.displayName="MDXCreateElement"},5763:function(e,t,n){n.r(t),n.d(t,{assets:function(){return d},contentTitle:function(){return i},default:function(){return m},frontMatter:function(){return l},metadata:function(){return p},toc:function(){return u}});var r=n(7462),s=n(3366),a=(n(7294),n(3905)),o=["components"],l={sidebar_position:1},i="Extensions to req and res",p={unversionedId:"learning/extensions",id:"learning/extensions",title:"Extensions to req and res",description:"wkrk offers a few handy methods to allow you to compose responses in an easy",source:"@site/docs/learning/extensions.md",sourceDirName:"learning",slug:"/learning/extensions",permalink:"/wkrk-docs/docs/learning/extensions",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/learning/extensions.md",tags:[],version:"current",sidebarPosition:1,frontMatter:{sidebar_position:1},sidebar:"tutorialSidebar",previous:{title:"Learning",permalink:"/wkrk-docs/docs/category/learning"},next:{title:"TypeScript",permalink:"/wkrk-docs/docs/learning/typescript"}},d={},u=[{value:"Extension to the Response Object",id:"extension-to-the-response-object",level:2},{value:"error",id:"error",level:3},{value:"get",id:"get",level:3},{value:"json",id:"json",level:3},{value:"redirect",id:"redirect",level:3},{value:"send",id:"send",level:3},{value:"set",id:"set",level:3},{value:"status",id:"status",level:3},{value:"statusCode",id:"statuscode",level:3},{value:"type",id:"type",level:3},{value:"How Extensions Work",id:"how-extensions-work",level:2}],c={toc:u};function m(e){var t=e.components,n=(0,s.Z)(e,o);return(0,a.kt)("wrapper",(0,r.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"extensions-to-req-and-res"},"Extensions to req and res"),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"wkrk")," offers a few handy methods to allow you to compose responses in an easy\nway. Also, we offer you with some new methods to get data from the current\nrequest object."),(0,a.kt)("h2",{id:"extension-to-the-response-object"},"Extension to the Response Object"),(0,a.kt)("h3",{id:"error"},"error"),(0,a.kt)("p",null,"Sets the status code to ",(0,a.kt)("inlineCode",{parentName:"p"},"500")," and sends the provided parameter as the response body."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"res.error('There has been an error')\n")),(0,a.kt)("p",null,"It calls ",(0,a.kt)("a",{parentName:"p",href:"#send"},".send")," internally, so it follows the same serialization rules."),(0,a.kt)("h3",{id:"get"},"get"),(0,a.kt)("p",null,"Returns the associated header from the response object:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},'res.set("Content-Type", "text/png")\nres.get("Content-Type") // "text/png"\n')),(0,a.kt)("h3",{id:"json"},"json"),(0,a.kt)("p",null,"Created a response with the json format and headers:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},'res.json({ username: "giovannibenussi" });\n')),(0,a.kt)("p",null,"The code above sets the ",(0,a.kt)("inlineCode",{parentName:"p"},"Content-Type")," automatically to ",(0,a.kt)("inlineCode",{parentName:"p"},"application/json")," and\ntransform que provided parameter to a JSON string."),(0,a.kt)("p",null,"It will consider any previous state set to the response object:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"res.set('x-debug', 'abcdefghijklm')\nres.status(200).json({ username: \"giovannibenussi\" });\n")),(0,a.kt)("h3",{id:"redirect"},"redirect"),(0,a.kt)("p",null,"Redirects the request to the specified URL:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"res.redirect('https://www.giovannibenussi.com/')\n")),(0,a.kt)("p",null,"The default status code for this method is ",(0,a.kt)("inlineCode",{parentName:"p"},"307")," (",(0,a.kt)("a",{parentName:"p",href:"https://stackoverflow.com/questions/2068418/whats-the-difference-between-a-302-and-a-307-redirect"},"temporary redirect"),"). However, it also accepts a custom status code as a second parameter:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"res.redirect('https://www.giovannibenussi.com/', 308)\n")),(0,a.kt)("p",null,"As opposed to ",(0,a.kt)("a",{parentName:"p",href:"https://developer.mozilla.org/en-US/docs/Web/API/Response/redirect"},(0,a.kt)("inlineCode",{parentName:"a"},"Response.redirect")),", it accepts relative paths:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"res.redirect('/welcome')\nres.redirect('./posts')\nres.redirect('../users')\n")),(0,a.kt)("h3",{id:"send"},"send"),(0,a.kt)("p",null,"Creates a response with the provided parameter as the response body:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"res.send('hello world');\n")),(0,a.kt)("p",null,"Parameters are converted to their JSON representation (except for strings) prior returning a response, so you can provide any serializable parameter:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"res.send({ hello: 'world' }); // object\nres.send([1, 2, 3, 4]); // array \nres.send(1); // number \n")),(0,a.kt)("p",null,"This method automatically sets the ",(0,a.kt)("inlineCode",{parentName:"p"},"Content-Type")," header if not present depending on its type according to the following rules:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"string"),": ",(0,a.kt)("inlineCode",{parentName:"li"},"Content-Type")," is set to ",(0,a.kt)("inlineCode",{parentName:"li"},"text/html"),"."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"serializable object"),": ",(0,a.kt)("inlineCode",{parentName:"li"},"Content-Type")," is set to ",(0,a.kt)("inlineCode",{parentName:"li"},"application/json"),".")),(0,a.kt)("h3",{id:"set"},"set"),(0,a.kt)("p",null,"Sets the associated header for the response object:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},'res.set("Content-Type", "text/png")\nres.get("Content-Type") // "text/png"\n')),(0,a.kt)("p",null,"You can also provide an object to set multiple headers at once:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"res.set({\n  'Content-Disposition', 'inline; filename=\"image.png\"',\n  'Content-Type', 'text/png'\n})\n")),(0,a.kt)("h3",{id:"status"},"status"),(0,a.kt)("p",null,"Sets the response status code:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},'res.status(200).json({ username: "giovannibenussi" });\n')),(0,a.kt)("h3",{id:"statuscode"},"statusCode"),(0,a.kt)("p",null,"Returns the status code of the response object:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"res.status(500)\nres.statusCode // 500\n")),(0,a.kt)("h3",{id:"type"},"type"),(0,a.kt)("p",null,"Sets the ",(0,a.kt)("inlineCode",{parentName:"p"},"Content-Type")," associated with the provided name, extension, or filename:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},'res.type("json") // application/json\nres.type(".md") // text/markdown\nres.type("static/index.html") // text/html\n')),(0,a.kt)("p",null,"Type mapping is provided by the ",(0,a.kt)("a",{parentName:"p",href:"https://www.npmjs.com/package/mime"},"mime/lite"),"\npackage."),(0,a.kt)("h2",{id:"how-extensions-work"},"How Extensions Work"),(0,a.kt)("p",null,"We have custom wrappers for the ",(0,a.kt)("inlineCode",{parentName:"p"},"req")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"res")," objects. We provide methods like\n",(0,a.kt)("inlineCode",{parentName:"p"},"json")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"send")," that generates a native ",(0,a.kt)("inlineCode",{parentName:"p"},"Response")," object so you can return\nthose in your handlers."),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"req")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"res")," are instances of ",(0,a.kt)("inlineCode",{parentName:"p"},"ExtendedRequest")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"ExtendedResponse")," from\nour library ",(0,a.kt)("inlineCode",{parentName:"p"},"wkrk-extended"),":"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"req.constructor.class // ExtendedRequest\nres.constructor.class // ExtendedResponse\n")),(0,a.kt)("p",null,"In the real world, you'll call methods on this objects that returns a native\n",(0,a.kt)("inlineCode",{parentName:"p"},"Request")," object:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"// both return an instance of the native `Response` object\nres.json({ username: \"giovannibenussi\" });\nres.send('hello world');\n")),(0,a.kt)("p",null,"This allows you to use this objects in your handlers seamlessly:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},'export default {\n  get(req, res) {\n    return res.status(200).json({ name: "Giovanni" });\n  },\n  post(req, res) {\n    return res.status(200).json({ success: true });\n  }\n};\n')))}m.isMDXComponent=!0}}]);